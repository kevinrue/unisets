<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using unisets with Bioconductor annotation packages • unisets</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using unisets with Bioconductor annotation packages">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">unisets</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic.html">An introduction to the unisets package 
</a>
    </li>
    <li>
      <a href="../articles/bioc-annotation.html">Using unisets with Bioconductor annotation packages
</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kevinrue/unisets">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Using unisets with Bioconductor annotation packages</h1>
                        <h4 class="author">Kevin Rue-Albrecht</h4>
            <address class="author_afil">
      Kennedy Institute of Rheumatology, University of Oxford, Headington, Oxford OX3 7FY, UK.<br><a class="author_email" href="mailto:#"></a><a href="mailto:kevin.rue-albrecht@kennedy.ox.ac.uk">kevin.rue-albrecht@kennedy.ox.ac.uk</a>
      </address>
                              <h4 class="author">Robert A. Amezquita</h4>
            <address class="author_afil">
      Fred Hutchinson Cancer Research Center, Seattle, WA, USA, 98115<br><a class="author_email" href="mailto:#"></a><a href="mailto:robert.amezquita@fredhutch.org">robert.amezquita@fredhutch.org</a>
      </address>
                  
            <h4 class="date">6 February 2019</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kevinrue/unisets/blob/master/vignettes/bioc-annotation.Rmd"><code>vignettes/bioc-annotation.Rmd</code></a></small>
      <div class="hidden name"><code>bioc-annotation.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      Importing gene set relationships from Bioconductor annotation packages.
    </div>
    
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<div id="bioconductor-annotation-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#bioconductor-annotation-packages" class="anchor"></a>Bioconductor annotation packages</h2>
<p>Annotation packages are available from Bioconductor for a range of model species. Users may browse <a href="https://bioconductor.org/packages/release/BiocViews.html#___AnnotationData">BiocViews “AnnotationData”</a> on the Bioconductor website or search packages programmatically using the command below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">BiocManager<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/BiocManager/topics/available">available</a></span>(<span class="st">"^org</span><span class="ch">\\</span><span class="st">."</span>)</a></code></pre></div>
<p>Here, we load the human gene annotations.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(org.Hs.eg.db)</a></code></pre></div>
</div>
</div>
<div id="converting-to-unisets-classes" class="section level1">
<h1 class="hasAnchor">
<a href="#converting-to-unisets-classes" class="anchor"></a>Converting to unisets classes</h1>
<p><code>Go3AnnDbBimap</code> objects (from the <em><a href="https://bioconductor.org/packages/3.9/AnnotationDbi">AnnotationDbi</a></em> package) are maps between Entrez gene identifiers and Gene Ontology (GO) identifiers. Those objects may be directly converted to <code>BaseSets</code> objects as demonstrated below.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(unisets)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">base_sets &lt;-<span class="st"> </span><span class="kw"><a href="../reference/import.html">import</a></span>(org.Hs.egGO)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="../reference/BaseSets-methods.html">relations</a></span>(base_sets)</a></code></pre></div>
<pre><code>## DataFrame with 313751 rows and 4 columns
##                 element        set    Evidence    Ontology
##        &lt;EntrezIdVector&gt; &lt;IdVector&gt; &lt;character&gt; &lt;character&gt;
## 1                     1 GO:0002576         TAS          BP
## 2                     1 GO:0008150          ND          BP
## 3                     1 GO:0043312         TAS          BP
## 4                     2 GO:0001869         IDA          BP
## 5                     2 GO:0002576         TAS          BP
## ...                 ...        ...         ...         ...
## 313747        110599583 GO:0046872         IEA          MF
## 313748        111089941 GO:0004571         IMP          MF
## 313749        111089941 GO:0004571         TAS          MF
## 313750        111089941 GO:0005509         IEA          MF
## 313751        112441434 GO:0005515         IPI          MF</code></pre>
<p>Notice how the <code>"element"</code> information is typed as <code>EntrezIdVector</code>, allowing the type of identifier to affect downstream methods (e.g., pathway analyses). The <code>EntrezIdVector</code> class directly inherits from the <code>IdVector</code> class, and benefits of all the methods associated with the parent class.</p>
<p>It is also useful to note that the conversion of <code>Go3AnnDbBimap</code> Gene Ontology maps to <em><a href="https://github.com/kevinrue/unisets">unisets</a></em> objects automatically fetches metadata for each GO identifier from the <code>GO.db</code> package, if installed. The metadata is stored it in the <code>mcols</code> (metadata-columns) slot of the <code>setData</code> slot of the object returned. This metadata can be accessed using the accessor method of the same name.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">mcols</span>(<span class="kw"><a href="../reference/BaseSets-methods.html">setData</a></span>(base_sets))[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"ONTOLOGY"</span>, <span class="st">"TERM"</span>)]</a></code></pre></div>
<pre><code>## DataFrame with 17983 rows and 2 columns
##               ONTOLOGY
##            &lt;character&gt;
## GO:0002576          BP
## GO:0008150          BP
## GO:0043312          BP
## GO:0001869          BP
## GO:0007597          BP
## ...                ...
## GO:0047349          MF
## GO:0070567          MF
## GO:0047547          MF
## GO:0047613          MF
## GO:0050337          MF
##                                                                    TERM
##                                                             &lt;character&gt;
## GO:0002576                                       platelet degranulation
## GO:0008150                                           biological_process
## GO:0043312                                     neutrophil degranulation
## GO:0001869 negative regulation of complement activation, lectin pathway
## GO:0007597                         blood coagulation, intrinsic pathway
## ...                                                                 ...
## GO:0047349          D-ribitol-5-phosphate cytidylyltransferase activity
## GO:0070567                                cytidylyltransferase activity
## GO:0047547                         2-methylcitrate dehydratase activity
## GO:0047613                             aconitate decarboxylase activity
## GO:0050337                 thiosulfate-thiol sulfurtransferase activity</code></pre>
<p>We may then visualize the distribution of set sizes, on a log<sub>10</sub> scale.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(cowplot)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">setLengths=</span><span class="kw"><a href="../reference/BaseSets-methods.html">setLengths</a></span>(base_sets))) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(setLengths), <span class="dt">bins=</span><span class="dv">100</span>, <span class="dt">color=</span><span class="st">"black"</span>, <span class="dt">fill=</span><span class="st">"grey"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span>() <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">y=</span><span class="st">"Sets"</span>, <span class="dt">x=</span><span class="st">"Genes"</span>)</a></code></pre></div>
<p><img src="bioc-annotation_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p><code>org.Hs.egGO</code> is an R object that provides mappings between entrez gene identifiers and the GO identifiers that they are directly associated with. This mapping and its reverse mapping do NOT associate the child terms from the GO ontology with the gene. Only the directly evidenced terms are represented here.</p>
<p>In contrast, <code>org.Hs.egGO2ALLEGS</code> is an R object that provides mappings between a given GO identifier and all of the Entrez Gene identifiers annotated at that GO term OR TO ONE OF IT’S CHILD NODES in the GO ontology. Thus, this mapping is much larger and more inclusive than <code>org.Hs.egGO2EG</code>.</p>
<p>Below, we use the <code>length</code> method to show the number of relations between genes and GO terms imported from the <code>org.Hs.egGO2ALLEGS</code> map.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">base_sets &lt;-<span class="st"> </span><span class="kw"><a href="../reference/import.html">import</a></span>(org.Hs.egGO2ALLEGS)</a></code></pre></div>
<pre><code>## 'select()' returned 1:1 mapping between keys and columns</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/format">format</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(base_sets), <span class="dt">big.mark=</span><span class="st">","</span>)</a></code></pre></div>
<pre><code>## [1] "3,430,396"</code></pre>
<p>We can also examine the count of relations associated with each evidence code in each Gene Ontology namespace.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="../reference/BaseSets-methods.html">as.data.frame</a></span>(base_sets)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(Evidence)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span>Ontology, <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">    </span><span class="co"># scale_y_continuous(labels = function(x){ format(as.integer(x), big.mark = ",") }) +</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span>(<span class="dt">labels =</span> scales<span class="op">::</span>comma) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">axis.text.y =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size=</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">rel</a></span>(<span class="fl">0.7</span>)))</a></code></pre></div>
<p><img src="bioc-annotation_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<pre><code>## R Under development (unstable) (2019-02-06 r76066)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 14.04.5 LTS
## 
## Matrix products: default
## BLAS: /home/travis/R-bin/lib/R/lib/libRblas.so
## LAPACK: /home/travis/R-bin/lib/R/lib/libRlapack.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] cowplot_0.9.4        ggplot2_3.1.0        unisets_0.99.0      
##  [4] org.Hs.eg.db_3.7.0   AnnotationDbi_1.45.0 IRanges_2.17.4      
##  [7] S4Vectors_0.21.10    Biobase_2.43.1       BiocGenerics_0.29.1 
## [10] BiocStyle_2.11.0    
## 
## loaded via a namespace (and not attached):
##  [1] bit64_0.9-7                 assertthat_0.2.0           
##  [3] BiocManager_1.30.4          blob_1.1.1                 
##  [5] GenomeInfoDbData_1.2.0      Rsamtools_1.35.2           
##  [7] yaml_2.2.0                  pillar_1.3.1               
##  [9] RSQLite_2.1.1               backports_1.1.3            
## [11] lattice_0.20-38             digest_0.6.18              
## [13] GenomicRanges_1.35.1        XVector_0.23.0             
## [15] colorspace_1.4-0            htmltools_0.3.6            
## [17] Matrix_1.2-15               plyr_1.8.4                 
## [19] GSEABase_1.45.0             XML_3.98-1.16              
## [21] pkgconfig_2.0.2             bookdown_0.9               
## [23] zlibbioc_1.29.0             xtable_1.8-3               
## [25] GO.db_3.7.0                 scales_1.0.0               
## [27] BiocParallel_1.17.9         tibble_2.0.1               
## [29] annotate_1.61.0             withr_2.1.2                
## [31] SummarizedExperiment_1.13.0 lazyeval_0.2.1             
## [33] magrittr_1.5                crayon_1.3.4               
## [35] memoise_1.1.0               evaluate_0.12              
## [37] fs_1.2.6                    MASS_7.3-51.1              
## [39] xml2_1.2.0                  graph_1.61.0               
## [41] tools_3.6.0                 matrixStats_0.54.0         
## [43] stringr_1.3.1               munsell_0.5.0              
## [45] DelayedArray_0.9.8          Biostrings_2.51.2          
## [47] compiler_3.6.0              pkgdown_1.3.0              
## [49] GenomeInfoDb_1.19.1         rlang_0.3.1                
## [51] grid_3.6.0                  RCurl_1.95-4.11            
## [53] labeling_0.3                bitops_1.0-6               
## [55] rmarkdown_1.11              gtable_0.2.0               
## [57] DBI_1.0.0                   roxygen2_6.1.1             
## [59] reshape2_1.4.3              R6_2.3.0                   
## [61] GenomicAlignments_1.19.1    knitr_1.21                 
## [63] rtracklayer_1.43.1          bit_1.1-14                 
## [65] commonmark_1.7              rprojroot_1.3-2            
## [67] desc_1.2.0                  stringi_1.2.4              
## [69] Rcpp_1.0.0                  xfun_0.4</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#getting-started">Getting started</a><ul class="nav nav-pills nav-stacked">
<li><a href="#bioconductor-annotation-packages">Bioconductor annotation packages</a></li>
      </ul>
</li>
      <li><a href="#converting-to-unisets-classes">Converting to unisets classes</a></li>
      <li><a href="#session-info">Session info</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Kevin Rue-Albrecht, Robert Amezquita.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
